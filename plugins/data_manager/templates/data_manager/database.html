{% extends "data_manager/base.html" %}

{% block title %}Base de Datos: {{ db_name }}{% endblock %}

{% block content %}
<div class="max-w-full mx-auto bg-gray-800 rounded-lg shadow-md p-6">
    <table class="w-full text-center">
        <thead>
            <tr>
                <th class="px-4 py-2">Id</th>
                <th class="px-4 py-2">Nombre de la base de datos</th>
                <th class="px-4 py-2">Última edición</th>
                <th class="px-4 py-2">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for user_file in user_files %}
            <tr>
                <td class="px-4 py-2">{{ user_file.id }}</td>
                <td class="px-4 py-2">{{ user_file.db_file }}</td>
                <td class="px-4 py-2">{{ user_file.edition_datetime|date:"Y-m-d H:i:s" }}</td>
                <td class="px-4 py-2">
                    <a href="#" class="edit-icon" onclick="openRenameModal('{{ user_file.db_file }}')">✏️</a>
                    <a href="#" class="delete-icon" onclick="openDeleteModal('{{ user_file.id }}')">🗑️</a>
                    <a href="#" class="info-icon" onclick="openInfoModal('{{ user_file.id }}')">ℹ️</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div id="rename-modal" class="modal hidden">
    <div class="modal-content">
        <span class="close" onclick="closeRenameModal()">&times;</span>
        <h2>Renombrar Base de Datos</h2>
        <form id="rename-form" method="post" action="{% url 'data_manager:rename_database' %}">
            {% csrf_token %}
            <label for="db_name">Base de datos actual: <span id="current_db_name"></span></label>
            <input type="hidden" name="db_name" value=""><br>
            <input type="hidden" name="id" value=""><br>
            <label for="new_db_name">Nuevo nombre: </label><br>
            <input type="text" name="new_db_name" id="new_db_name" required><br>
            <button type="submit"> Renombrar</button>
        </form>
    </div>
</div>
<div id="delete-modal" class="modal hidden">
    <div class="modal-content">
        <span class="close" onclick="closeDeleteModal()">&times;</span>
        <h2>Advertencia</h2>
        <p>¿Estás seguro de que deseas eliminar esta base de datos? Esta acción no se puede deshacer.</p>
        <button id="confirm-delete" class="bg-red-600 text-white">Eliminar Definitivamente</button>
        <button onclick="closeDeleteModal()">Cancelar</button>
    </div>
</div>
<div id="info-modal" class="modal hidden">
    <div class="modal-content">
        <span class="close" onclick="closeInfoModal()">&times;</span>
        <h2>Información de la Base de Datos</h2>
        <div id="info-content"></div>
    </div>
</div>
{% endblock %}
